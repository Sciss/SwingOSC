<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta http-equiv="Content-Style-Type" content="text/css">
<title></title>
<meta name="Generator" content="Cocoa HTML Writer">
<meta name="CocoaVersion" content="824.48">
<style type="text/css">
p.p1 {margin: 0.0px 0.0px 11.0px 0.0px; font: 14.0px Lucida Grande; color: #000000}
p.p2 {margin: 0.0px 0.0px 16.0px 0.0px; font: 24.0px Lucida Grande; color: #0000bf}
p.p3 {margin: 0.0px 0.0px 12.0px 0.0px; font: 12.0px Lucida Grande; color: #000000}
p.p4 {margin: 0.0px 0.0px 0.0px 0.0px; font: 10.0px Monaco; color: #000000}
p.p5 {margin: 0.0px 0.0px 0.0px 0.0px; font: 10.0px Monaco; color: #000000; min-height: 14.0px}
p.p6 {margin: 0.0px 0.0px 0.0px 0.0px; font: 10.0px Monaco; color: #bf0000}
p.p7 {margin: 0.0px 0.0px 0.0px 0.0px; font: 10.0px Monaco; color: #bf0000; min-height: 14.0px}
p.p8 {margin: 0.0px 0.0px 0.0px 0.0px; font: 10.0px Monaco; color: #0000bf}
p.p9 {margin: 0.0px 0.0px 0.0px 0.0px; font: 9.0px Monaco; color: #000000}
span.s1 {color: #0000bf}
span.s2 {color: #000000}
span.s3 {text-decoration: underline ; color: #0000bf}
span.s4 {color: #606060}
span.s5 {color: #007300}
span.s6 {font: 10.0px Monaco; color: #0000bf}
span.s7 {font: 10.0px Monaco}
span.Apple-tab-span {white-space:pre}
</style>
</head>
<body>
<h2 style="margin: 0.0px 0.0px 11.0px 0.0px; font: 14.0px Lucida Grande; color: #000000"><span class="s1"><b>SwingOSC</b></span><b> – </b><span class="s1"><b>Java</b></span><b>-based </b><span class="s1"><b>GUI</b></span><b> classes</b></h2>
<h1 style="margin: 0.0px 0.0px 16.0px 0.0px; font: 24.0px Lucida Grande; color: #0000bf"><b>JSCPeakMeterView</b></h1>
<p class="p2"><span class="s2"><b>!!!</b></span><b>INCOMPLETE</b><span class="s2"><b>!!!</b></span></p>
<p class="p3"><b>Note: please use the abstraction layer </b><span class="s1"><b>GUI</b></span><b>.peakMeterView if possible! (see </b><a href="SC://GUI"><span class="s1"><b>GUI</b></span></a><b>).</b> <span class="s1">See</span> also <a href="JSCView.html"><span class="s3">JSCView</span></a>.</p>
<p class="p4">s.boot;</p>
<p class="p5"><br></p>
<p class="p4">(</p>
<p class="p4"><span class="Apple-converted-space">    </span>w = <span class="s1">JSCWindow</span>( <span class="s4">"Meter"</span>, <span class="s1">Rect</span>( 200, 200, 128, 225 ), <span class="s1">false</span> );</p>
<p class="p4"><span class="Apple-converted-space">    </span>b = <span class="s1">JSCPeakMeterView</span>( w, <span class="s1">Rect</span>( 4, 4, 56, 217 ));</p>
<p class="p4"><span class="Apple-converted-space">    </span>b.bus = <span class="s1">Bus</span>( <span class="s5">\audio</span>, s.options.numOutputBusChannels, 2, s );</p>
<p class="p4"><span class="Apple-converted-space">    </span>w.front;</p>
<p class="p4">)</p>
<p class="p5"><br></p>
<p class="p4">b.border = <span class="s1">true</span>;</p>
<p class="p4">b.border = <span class="s1">false</span>;</p>
<p class="p4">b.caption = <span class="s1">true</span>;</p>
<p class="p4">b.caption = <span class="s1">false</span>;</p>
<p class="p4">b.caption = <span class="s1">true</span>;</p>
<p class="p4">b.font = <span class="s1">JFont</span>( <span class="s4">"Eurostile"</span>, 11 );</p>
<p class="p4">b.font = <span class="s1">JFont</span>( <span class="s4">"Andale Mono"</span>, 13 );</p>
<p class="p4">b.captionVisible = <span class="s1">false</span>;</p>
<p class="p4">b.captionVisible = <span class="s1">true</span>;</p>
<p class="p4">b.captionPosition = <span class="s5">\right</span>;</p>
<p class="p4">b.captionPosition = <span class="s5">\left</span>;</p>
<p class="p4">b.captionPosition = <span class="s5">\center</span>;</p>
<p class="p4">b.rmsPainted = <span class="s1">false</span>;</p>
<p class="p4">b.rmsPainted = <span class="s1">true</span>;</p>
<p class="p4">b.holdPainted = <span class="s1">false</span>;</p>
<p class="p4">b.holdPainted = <span class="s1">true</span>;</p>
<p class="p5"><br></p>
<p class="p6">/*</p>
<p class="p6">b.bus = Bus( \audio, s.options.numOutputBusChannels, 4, s );</p>
<p class="p6">b.bounds = Rect( 4, 4, 72, 217 );</p>
<p class="p6">//b.refresh;</p>
<p class="p7"><br></p>
<p class="p6">b.bounds = Rect( 4, 4, 120, 217 );</p>
<p class="p6">//b.refresh;</p>
<p class="p6">*/</p>
<p class="p5"><br></p>
<p class="p4">s.boot;</p>
<p class="p5"><br></p>
<p class="p4">b.mouseDownAction = { <span class="s4">"Doing!"</span>.postln };</p>
<p class="p5"><br></p>
<p class="p5"><br></p>
<p class="p4">(</p>
<p class="p4"><span class="s1">SynthDef</span>( <span class="s4">"eisk-meter"</span>, { <span class="s1">arg</span> i_aInBs = 0, i_kOtBs, t_trig;</p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="s1">var</span> in, rms, peak;</p>
<p class="p5"><span class="Apple-tab-span">	</span></p>
<p class="p4"><span class="Apple-tab-span">	</span>in<span class="Apple-tab-span">	</span>= <span class="s1">In</span>.ar( i_aInBs );</p>
<p class="p6"><span class="s2"><span class="Apple-tab-span">	</span>rms<span class="Apple-tab-span">	</span>= </span><span class="s1">Lag</span><span class="s2">.ar( in.squared, 0.1 );<span class="Apple-tab-span">	</span></span>// Amplitude.ar reports strange things (at least not the RMS)</p>
<p class="p6"><span class="s2"><span class="Apple-tab-span">	</span></span>// peak nowaday DOES take the abs</p>
<p class="p6">//<span class="Apple-tab-span">	</span>peak<span class="Apple-tab-span">	</span>= Peak.ar( abs( in ), t_trig );</p>
<p class="p4"><span class="Apple-tab-span">	</span>peak<span class="Apple-tab-span">	</span>= <span class="s1">Peak</span>.ar( in, t_trig );</p>
<p class="p5"><span class="Apple-tab-span">	</span></p>
<p class="p6"><span class="s2"><span class="Apple-tab-span">	</span></span>// we are reading the values asynchronously through</p>
<p class="p6"><span class="s2"><span class="Apple-tab-span">	</span></span>// a /c_getn on the meter bus. each request is followed</p>
<p class="p6"><span class="s2"><span class="Apple-tab-span">	</span></span>// by a /n_set to re-trigger the latch so that we are</p>
<p class="p6"><span class="s2"><span class="Apple-tab-span">	</span></span>// not missing any peak values.</p>
<p class="p4"><span class="Apple-tab-span">	</span><span class="s1">Out</span>.kr( i_kOtBs, [ <span class="s1">Latch</span>.kr( peak, t_trig ), rms ]);</p>
<p class="p5"><span class="Apple-tab-span">	</span></p>
<p class="p4">}).send( s );</p>
<p class="p4">)</p>
<p class="p5"><br></p>
<p class="p6">//x = Synth( "eisk-meter", [ \i_aInBs, b.bus.index, \i_kOtBs, ~cbus.index ], target: ~group );</p>
<p class="p6">//b.group = Group.tail( s );</p>
<p class="p4">b.active = <span class="s1">true</span>;</p>
<p class="p4">~synth = 2.collect({ <span class="s1">arg</span> i; <span class="s1">Synth</span>.basicNew( <span class="s4">"eisk-meter"</span>, s )});</p>
<p class="p6">//~group = Group.tail( s );</p>
<p class="p4">s.listSendBundle( <span class="s1">nil</span>, x.collect({ <span class="s1">arg</span> synth, i; synth.newMsg( b.group, [ <span class="s5">\i_aInBs</span>, b.bus.index + i, <span class="s5">\i_kOtBs</span>, ~cbus.index + (i &lt;&lt; 1) ])}));</p>
<p class="p5"><br></p>
<p class="p4">s.dumpOSC( 0 )</p>
<p class="p5"><br></p>
<p class="p6">// ~dust = { arg freq = 1000; Dust.ar( freq )}.play;</p>
<p class="p5"><br></p>
<p class="p4">~rout = fork { <span class="s1">inf</span>.do({ s.sendBundle( <span class="s1">nil</span>, [ <span class="s5">'/c_getn'</span>, ~cbus.index, 4 ], [ <span class="s5">'/n_set'</span>, ~group.nodeID, <span class="s5">\t_trig</span>, 1 ]); 0.03.wait })};</p>
<p class="p5"><br></p>
<p class="p4">s.dumpOSC( 1 )</p>
<p class="p4">s.dumpOSC( 0 )</p>
<p class="p4">g.dumpOSC( 0 )</p>
<p class="p5"><br></p>
<p class="p4">b.active = <span class="s1">false</span>;</p>
<p class="p5"><br></p>
<p class="p4">s.sendMsg( <span class="s5">'/n_set'</span>, ~group.nodeID, <span class="s5">\t_trig</span>, 1 );</p>
<p class="p4">~group.trace</p>
<p class="p5"><br></p>
<p class="p4">~meter = <span class="s1">JavaObject</span>.basicNew( b.id, b.server );</p>
<p class="p5"><br></p>
<p class="p4">~resp = <span class="s1">OSCpathResponder</span>( s.addr, [ <span class="s5">'/c_setn'</span>, 0, 4 ], { <span class="s1">arg</span> time, resp, msg; ~meter.meterUpdate( msg.copyToEnd( 3 ), 0, 0 )}).add;</p>
<p class="p5"><br></p>
<p class="p8">SystemClock<span class="s2">.seconds</span></p>
<p class="p8">thisThread<span class="s2">.seconds</span></p>
<p class="p4"><span class="s1">Date</span>.getDate</p>
<p class="p8">thisThread<span class="s2">.elapsed</span></p>
<p class="p9"><span class="s6">Process</span><span class="s7">.</span>elapsedTime</p>
<p class="p5"><br></p>
<p class="p4">~resp.remove;</p>
<p class="p5"><br></p>
<p class="p4"><span class="Apple-tab-span">	</span>public boolean meterUpdate( float[] peakRMSPairs, int offset, long time );</p>
<p class="p5"><br></p>
<p class="p5"><br></p>
<p class="p4">b.active = <span class="s1">false</span>;</p>
<p class="p4">x.do(<span class="s1">_</span>.free)</p>
<p class="p5"><br></p>
<p class="p4">b.manager</p>
</body>
</html>
